name: Check license

on:
  pull_request:
    # This ignore list does not cover the entire set of irrelevant files, but it
    # saves resources in many cases.
    paths-ignore:
      - '.github/**'
      - '*.md'
      - '**/*.lock'
      - '**/*.json'

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5

      # - uses: tj-actions/changed-files@dcc7a0cba800f454d79fff4b993e8c3555bcc0a8 # v45
      #   id: changed-files
      #   with:
      #     files_ignore: |
      #       /*.md
      #       **/*.lock
      #       **/*.json
      #       doc/*.*
      #       dev/**
      #       .github/**

      - uses: cachix/install-nix-action@7be5dee1421f63d07e71ce6e0a9f8a4b07c2a487 # v31

      - run: nix profile install nixpkgs#reuse

      - name: Check license
        run: 'reuse lint-file ${{ steps.changed-files.outputs.all_changed_files }}'
